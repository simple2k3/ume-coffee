{% extends 'base.html' %}
{% load static %}

{% block title %}{{ product.product_name }} - UME Coffee{% endblock %}

{% block extra_head %}
<style>
/* Chỉ CSS riêng cho trang product detail */
#product-details,
#suggested-products {
  position: relative;
  background: url('{% static "assets/img/background.jpg" %}') no-repeat center center;
  background-size: cover;
  padding: 60px 0;
}
/* ... CSS khác ... */
</style>
{% endblock %}

{% block content %}
<main class="main portfolio-details-page">
  <section id="product-details" class="portfolio-details section">
    <div class="container" data-aos="fade-up">
      <div class="row gy-4">
        <div class="col-lg-8">
          <div class="portfolio-details-slider swiper init-swiper">
            <div class="swiper-wrapper align-items-center">
              {% if product.image %}
              <div class="swiper-slide">
                <img src="{{ product.image }}" alt="{{ product.product_name }}">
              </div>
              {% endif %}
              {% for detail in details %}
              {% if detail.image %}
              <div class="swiper-slide">
                <img src="{{ detail.image }}" alt="Chi tiết ảnh">
              </div>
              {% endif %}
              {% endfor %}
            </div>
            <div class="swiper-pagination"></div>
          </div>
        </div>

        <div class="col-lg-4">
          <div class="portfolio-info">
            <h3>{{ product.product_name }}</h3>
            <ul>
              <li><strong>Mã sản phẩm:</strong> {{ product.product_code }}</li>
              <li><strong>Giá:</strong> {{ product.base_price }} VNĐ</li>
              <li><strong>Trạng thái:</strong>
                {% if details.0.is_available %}
                  <span class="text-success">Còn hàng</span>
                {% else %}
                  <span class="text-danger">Hết hàng</span>
                {% endif %}
              </li>
              <li><strong>Ngày cập nhật:</strong> {{ product.update_time|date:"d/m/Y H:i" }}</li>
            </ul>
          </div>
          <div class="portfolio-description mt-3">
            <h4>Mô tả sản phẩm</h4>
            {% if details %}
              {% for detail in details %}
                {% if detail.description %}
                  <p>{{ detail.description }}</p>
                {% endif %}
              {% endfor %}
            {% else %}
              <p>Chưa có mô tả chi tiết cho sản phẩm này.</p>
            {% endif %}
          </div>
        </div>
      </div>
    </div>
  </section>

  <section id="suggested-products" class="section mt-5">
    <div class="container">
      <h3 class="mb-4">Sản phẩm gợi ý</h3>
      <div class="row gy-4">
        {% for p in suggested_products %}
        <div class="col-lg-3 col-md-4 col-6">
          <div class="card">
            {% if p.image %}
              <img src="{{ p.image }}" class="card-img-top" alt="{{ p.product_name }}">
            {% endif %}
            <div class="card-body text-center">
              <h6 class="card-title">{{ p.product_name }}</h6>
              <p class="card-text">{{ p.base_price }} VNĐ</p>
              <a href="{% url 'product_detail' p.product_code %}" class="btn btn-primary btn-sm">Xem chi tiết</a>
            </div>
          </div>
        </div>
        {% endfor %}
      </div>
    </div>
  </section>
</main>
{% endblock %}
