{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{% block title %}UME Coffee{% endblock %}</title>

  <!-- Favicon -->
  <link rel="icon" href="{% static 'assets/img/favicon.png' %}">
  <link rel="apple-touch-icon" href="{% static 'assets/img/apple-touch-icon.png' %}">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com" rel="preconnect">
  <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">

  <!-- Vendor CSS -->
  <link rel="stylesheet" href="{% static 'assets/vendor/bootstrap/css/bootstrap.min.css' %}">
  <link rel="stylesheet" href="{% static 'assets/vendor/bootstrap-icons/bootstrap-icons.css' %}">
  <link rel="stylesheet" href="{% static 'assets/vendor/aos/aos.css' %}">
  <link rel="stylesheet" href="{% static 'assets/vendor/swiper/swiper-bundle.min.css' %}">
  <link rel="stylesheet" href="{% static 'assets/vendor/glightbox/css/glightbox.min.css' %}">

  <!-- Main CSS -->
  <link href="{% static 'assets/css/main.css' %}" rel="stylesheet">

  <style>
    /* =================== Tổng thể =================== */
body {
    margin: 0;
    padding: 0;
    background: #fff;
}

/* Header trong suốt */
#header.header {
    background: #fff;
    border: none;
    box-shadow: none;
    padding: 10px 20px;
}

/* Header container: desktop */
#header .container-xl {
    display: flex;
    align-items: center;
    justify-content: space-between;
}

/* Logo */
.logo {
    display: flex;
    align-items: center;
    gap: 10px;
}

.logo img {
    height: 40px;
}

.sitename {
    font-size: 20px;
    font-weight: 600;
}

/* =================== Menu chính =================== */
.navmenu {
    display: flex;
    align-items: center;
}

.navmenu ul {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    gap: 20px;
}

.navmenu li {
    position: relative;
}

/* Dropdown */
.navmenu ul ul {
    display: none;
    position: absolute;
    top: 100%;
    left: 0;
    background: #fff;
    box-shadow: 0 4px 12px rgba(0,0,0,0.12);
    border-radius: 8px;
    min-width: 220px;
    padding: 8px 0;
    z-index: 1000;
}

/* reset li */
.navmenu ul ul li {
    width: 100%;
    margin: 0;
}

/* canh thẳng hàng text */
.navmenu ul ul li a {
    display: flex;
    align-items: center;
    padding: 10px 18px;
    font-size: 14px;
    font-weight: 500;
    color: #333;
    text-decoration: none;
    white-space: nowrap;
}

/* hover đẹp */
.navmenu ul ul li a:hover {
    background-color: #f8f9fa;
    color: #000;
}

/* =================== Thanh tìm kiếm =================== */
.search-form {
    display: flex;
    align-items: center;
    max-width: 350px;
}

.search-input {
    border-radius: 20px;
    padding: 6px 12px;
    border: 1px solid #ddd;
    flex: 1;
    transition: 0.3s;
}

.search-input:focus {
    border-color: #000;
    box-shadow: none;
}

.search-form button {
    border-radius: 50%;
    width: 38px;
    height: 38px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-left: 8px;
}

/* =================== Biểu tượng giỏ hàng / chuông =================== */
.header-cart, .header-bell {
    position: relative;
    display: flex;
    align-items: center;
}

.cart-icon, .bell-icon {
    display: inline-block;
    padding: 8px;
    border-radius: 50%;
    transition: background-color 0.3s;
}

.cart-icon:hover, .bell-icon:hover {
    background-color: rgba(0, 0, 0, 0.05);
}

.cart-badge {
    font-size: 0.7rem;
    width: 18px;
    height: 18px;
    display: flex;
    align-items: center;
    justify-content: center;
}

/* =================== Responsive =================== */

/* Tablet / Laptop */
@media (max-width: 992px) {
    .logo img {
        height: 35px;
    }
    .sitename {
        font-size: 18px;
    }

    #navmenu ul {
        display: none;
        flex-direction: column;
        width: 100%;
        position: absolute;
        top: 70px;
        left: 0;
        background: #fff;
        padding: 15px 20px;
        gap: 15px;
        z-index: 9999;
        box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }

    #navmenu ul.show {
        display: flex;
    }

    /* Dropdown trong mobile */
    #navmenu ul ul {
        position: static;
        width: 100%;
        box-shadow: none;
        margin-top: 10px;
        background: #f8f8f8;
        padding: 10px;
        border-radius: 6px;
    }

   /* =================== Thanh tìm kiếm =================== */
.search-form {
    display: flex;
    align-items: center;
    max-width: 350px;
}

/* Desktop: search ngang, trong header */
.search-form {
    margin-left: auto; /* đẩy sang phải */
}

/* Input & nút */
.search-input {
    border-radius: 20px;
    padding: 6px 12px;
    border: 1px solid #ddd;
    flex: 1;
    transition: 0.3s;
}

.search-input:focus {
    border-color: #000;
    box-shadow: none;
}

.search-form button {
    border-radius: 50%;
    width: 38px;
    height: 38px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-left: 8px;
}

/* ====== Mobile <576px: search nằm bên dưới menu ====== */
@media (max-width: 576px) {
    #header.header {
        padding-bottom: 60px; /* đủ chỗ cho search xuống dưới */
        position: relative;
        flex-wrap: wrap; /* cho header xếp các dòng */
    }

    .search-form {
        position: absolute;
        bottom: -50px; /* nằm dưới menu */
        left: 0;
        width: 100%; /* trải dài */
        padding: 0 15px;
        z-index: 999;
    }

    /* Khi menu mobile mở: search trở thành static, không che menu */
    #navmenu ul.show ~ .search-form {
        position: static;
        margin-top: 10px;
    }
}


  </style>

  {% block extra_head %}{% endblock %}
</head>

<body>

<!-- ======= Header ======= -->
<header id="header" class="header sticky-top">
  <div class="container-xl">

    <!-- Logo -->
    <a href="{% url 'index_html' %}" class="logo d-flex align-items-center me-4">
      <img src="{% static 'assets/img/logo.jpg' %}" alt="UME Coffee">
      <h5 class="sitename ms-2">UME COFFEE</h5>
    </a>

    <!-- Menu chính -->
    <nav id="navmenu" class="navmenu">
      <ul>
        <li><a href="{% url 'index_html' %}" class="{% if request.path == '/' %}active{% endif %}">Trang Chủ</a></li>
        <li><a href="{% url 'portfolio' %}" class="{% if request.path == '/portfolio/' %}active{% endif %}">Danh mục</a></li>
        <li class="dropdown">
          <a href="#"><span>Các Loại Cà Phê</span> <i class="bi bi-chevron-down toggle-dropdown"></i></a>
          <ul>
            {% for category in categories_data %}
              <li><a href="{% url 'category_products' category.categories_id %}">{{ category.categories_name }}</a></li>
            {% endfor %}
          </ul>
        </li>
        <li><a href="{% url 'contact' %}" class="{% if request.path == '/contact/' %}active{% endif %}">Liên Hệ</a></li>
      </ul>
      <i class="mobile-nav-toggle d-xl-none bi bi-list"></i>
    </nav>

<!--      <form method="get" action="{% url 'search_products' %}" class="search-form d-flex align-items-center me-3">-->
<!--       <input-->
<!--          name="q"-->
<!--          class="form-control search-input"-->
<!--          placeholder="Tìm kiếm cà phê..."-->
<!--           value="{{ request.GET.q|default:'' }}">-->
<!--        <button type="submit" class="btn btn-dark ms-2">-->
<!--            <i class="bi bi-search"></i>-->
<!--         </button>-->
<!--      </form>&ndash;&gt;-->

    <!-- Biểu tượng bên phải -->
    <div class="d-flex align-items-center">
      <!-- Giỏ hàng -->
      <div class="header-cart position-relative me-3">
        <a href="{% url 'cart' %}" class="cart-icon text-dark position-relative">
          <i class="bi bi-cart fs-4"></i>
          {% with request.session.cart|length as cart_count %}
            {% if cart_count > 0 %}
              <span class="cart-badge position-absolute top-0 start-100 translate-middle rounded-circle bg-danger text-white">
                {{ cart_count }}
              </span>
            {% endif %}
          {% endwith %}
        </a>
      </div>

      <!-- Chuông thông báo -->
      <div class="header-bell position-relative me-3 dropdown">

      <!-- Danh sách thông báo -->
      <ul class="dropdown-menu dropdown-menu-end shadow-sm p-2" style="width: 320px;">
          {% if notifications %}
            {% for n in notifications %}
              <li class="border-bottom py-2">
                  <a href="{% url 'order_detail' n.order_id %}" class="text-decoration-none text-dark d-block">
                      <div>
                          <strong> Mã đơn:</strong> {{ n.order_id }}<br>
                          <strong> Khách hàng:</strong> {{ n.customer_name }}<br>
                          <strong> Tổng tiền:</strong> {{ n.amount|floatformat:0 }}₫<br>
                      </div>
                  </a>
              </li>
            {% endfor %}
          {% else %}
            <li class="text-center text-muted py-2">Không có đơn hàng trong phiên</li>
          {% endif %}
        </ul>
    </div>
  </div>
</header>
<!-- End Header -->

<!-- Messages -->
{% if messages %}
  <div class="container mt-3" id="message-container">
    {% for message in messages %}
      <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
        {{ message }}
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>
    {% endfor %}
  </div>
{% endif %}

{% block content %}{% endblock %}

<!-- ======= Footer ======= -->
<footer id="footer" class="footer text-center">
  <div class="container">
    <p>© <strong class="sitename">UME Coffee</strong> — Cao nguyên Vân Hòa, Đắk Lắk</p>
    <div class="social-links d-flex justify-content-center">
      <a href="#"><i class="bi bi-twitter-x"></i></a>
      <a href="#"><i class="bi bi-facebook"></i></a>
      <a href="#"><i class="bi bi-instagram"></i></a>
      <a href="#"><i class="bi bi-linkedin"></i></a>
    </div>
  </div>
</footer>
<!-- End Footer -->

<!-- Scroll Top -->
<a href="#" id="scroll-top" class="scroll-top d-flex align-items-center justify-content-center">
  <i class="bi bi-arrow-up-short"></i>
</a>

<!-- Vendor JS -->
<script src="{% static 'assets/vendor/bootstrap/js/bootstrap.bundle.min.js' %}"></script>
<script src="{% static 'assets/vendor/aos/aos.js' %}"></script>
<script src="{% static 'assets/vendor/swiper/swiper-bundle.min.js' %}"></script>
<script src="{% static 'assets/vendor/glightbox/js/glightbox.min.js' %}"></script>
<script src="{% static 'assets/vendor/isotope-layout/isotope.pkgd.min.js' %}"></script>

<!-- Main JS -->
<script src="{% static 'assets/js/main.js' %}"></script>

<script>
  // Tự ẩn thông báo sau 2 giây
  setTimeout(() => {
    const msgContainer = document.getElementById('message-container');
    if (msgContainer) {
      msgContainer.style.transition = "opacity 0.5s";
      msgContainer.style.opacity = 0;
      setTimeout(() => msgContainer.remove(), 500);
    }
  }, 2000);

  // Toggle menu mobile
  document.addEventListener('DOMContentLoaded', function() {
    const toggle = document.querySelector('.mobile-nav-toggle');
    const navMenu = document.querySelector('#navmenu ul');

    toggle.addEventListener('click', function() {
      navMenu.classList.toggle('show');
      this.classList.toggle('bi-x');
    });
  });
</script>

{% block extra_js %}{% endblock %}
</body>
</html>
